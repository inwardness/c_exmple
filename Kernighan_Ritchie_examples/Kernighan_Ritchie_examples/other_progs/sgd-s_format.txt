При выгрузке данных из контроллера (см. Пункт 3.3.3.1) создаётся файл с
расширением *.ccr, который содержит все записи, сохранённые в памяти
контроллера. Каждая запись имеет длину 512 байт. Формат одиночной записи
описывается следующей структурой:
struct Record {
uint8 t0;
uint8 t1;
uint8 t2;
uint8 t3;
uint8 t4;
uint8 t5;
int16 dtb;
uint16 uht;
uint16 ctb;
uint32 spid;
uint8 samples[202];
char strings[256];
uint8 mode;
uint8 compatibility;
uint8 protocol;
uint8 TB_polarity;
uint8 FO_polarity;
uint8 last_ready;
uint16 tone_duration;
uint16 TB_delay;
uint16 radio_delay;
uint8 radio_ampl;
uint8 shot_by_PPS;
uint8 ccf_max;
uint8 imp_mode;
uint8 interval;
uint8 leapS;
uint8 test;
uint8 file_version;
char empty[2];
uint32 Tus;
uint16 count;
char empty1[2];
uint32 serial_number;
127
Сиб Геофиз ПриборРуководство по эксплуатации
char empty2[3];
uint8 fdtb;
};
Первые 6 элементов, Tus и leapS представляют дату и время генерации сигнала
«ClkTB» (Time Break). Формат представления времени зависит от того, были ли
RTC синхронизированы с точным GPS временем, и от значения элемента
file_version.
При отсутствии синхронизации с GPS/ГЛОНАСС приёмником или при
значении file_version = 0xFF (устаревший формат):
• t0 = TB_year = (год — 2000). Если время и дата недействительны (нет
синхронизации с GPS временем и при этом элемент питания RTC
разряжен), то t0 = 0xFF. В этом случае остальные элементы
представления времени недействительны;
• t1 = TB_month = (месяц — 1);
• t2 = TB_day = (день — 1);
• t3 = TB_hour = час;
• t4 = TB_minute = минута;
• t5 = TB_second = секунда;
• Tus = доли секунды в микросекундах, 0 … 999999. Если RTC не были
синхронизированы с GPS/ГЛОНАСС приёмником, здесь всегда будет
0xFFFFFFFF;
• leapS = leap seconds, разность между GPS и UTC временем.
Если file_version = 1 и RTC синхронизированы с GPS/ГЛОНАСС приёмником:
• t1:t0 = TB_gps_week = «GPS week number», тип uint16, t1 — старший
байт;
• t5:t4:t3:t2 = TB_gps_time = «GPS time of week» в секундах, тип uint32, t5
— старший байт;
• Tus = доли секунды в микросекундах, 0 … 999999;
• leapS = leap seconds, разность между GPS и UTC временем.
Элементы dtb и fdtb представляют значение ДОМ (DTB):
• fdtb = 0xFF или 0x80 означает, что ДОМ не принята, и значение DTB
отсутствует;
• fdtb = 0 означает, что dtb содержит значение DTB с весом младшего
разряда 50 мкс;
• fdtb = 1 означает, что dtb содержит значение DTB с весом младшего
разряда 10 мкс;
• fdtb = 2 означает, что dtb содержит значение DTB с весом младшего
разряда 1 мкс.
128
Сиб Геофиз ПриборСистема синхронизации SGD-S
Элемент ctb представляет значение задержки детонатора CTB (подтверждённая
отметка момента ПОМ) с весом младшего разряда 10 мкс. CTB имеет значение,
только если ДОМ была принята.
Элемент uht представляет значение вертикального времени UHT с весом
младшего разряда 100 мкс. UHT имеет значение, только если ДОМ и ПОМ
были приняты.
Элемент spid представляет значение номера ПВ в шестнадцатеричном
представлении, т.е. от 0x00000000 до 0x99999999 соответствуют номерам
пикета 00000000 … 99999999. Если какая либо из цифр номера пикета не была
принята из-за помех в радиоканале, вместо неё присутствует цифра F, например
0x000012F4 — номер пикета был 1234, а цифра 3 не принята.
Элемент samples[] — массив данных канала вертикального времени,
переданный синхронизатором в сокращённом виде. Отсчёты могут принимать
значения от 0x00 до 0xFF, что в десятичном представлении соответствует 0x00
= -128, 0x80 = 0, 0xFF = +127. Первый элемент массива samples[0] должен быть
равен 0x80 (0 десятичное), иное значение показывает, что массив
недействителен.
Элемент strings[] содержит две null-terminated строки, которые контроллер
послал в сейсмостанцию после отстрела (раздел 6.1 строка (3)). Первая должна
начинаться с «*SGD-S...», вторая — с «$GPGGA...». Если начала строк иное,
значит, та или другая строка отсутствует.
Далее следуют некоторые параметры настройки контроллера:
• mode — режим работы контроллера, 0 - «ВДЩ.ВЗР», 1 - «ВДМ.ВЗР»;
• compatibility — совместимость в версией 7, 0 — нет, 1 — есть;
• protocol — протокол обмена с сейсмостанцией, 0 - «SERCEL», 1 -
«SERCEL+dtb», 2 - «SERCEL+sp», 3 - «INOVA», 4 - «Прогресс Т2»;
• TB_polarity — полярность импульса ClkTB, 0 - «X-», 1 - «X+»;
• FO_polarity — полярность FO, 0 - «-», 1 - «+»;
• last_ready - «Принимать код синхронизатора», 0 — нет, 1 — принимать;
• tone_duration — длительность тона в миллисекундах;
• TB_delay — задержка от НО, единица младшего разряда равна 100 мкс;
• radio_delay — задержка в радиоканале, единица младшего разряда равна
10 мкс;
• radio_ampl — двойная амплитуда сигнала на входе радиостанции,
единица младшего разряда равна 25 мВ;
• shot_by_PPS — состояние параметра «Взрыв по PPS».
Элемент ccf_max — пиковое значение на выходе корреляционного обработчика
129
Сиб Геофиз ПриборРуководство по эксплуатации
радиосигнала при приёме декодированной отметки момента ДОМ (DTB) в
процентах.
Элемент serial_number — десятичное число, представляющее дату выпуска и
номер контроллера, например «17013001» - год 2017, месяц 01, номер 3001
