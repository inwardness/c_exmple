При выгрузке данных из синхронизатора (см. Пункт 4.3.4.1) создаётся файл с
расширением *.ucr, который содержит все записи, сохранённые в памяти
синхронизатора. Каждая запись имеет длину 4224 байта. Формат одиночной
записи описывается следующей структурой:
struct Record {
uint16 uht;
uint16 ctb;
uint16 r_uht;
uint16 r_cap;
uint8 ccf_max;
uint6 file_version;
uint8 Imax;
uint8 Uin;
uint8 t0;
uint8 t1;
uint8 t2;
uint8 t3;
uint8 t4;
uint8 t5;
uint32 microsec;
uint32 serial_number;
uint32 shot_point;
int32 SP_step;
uint32 line_number;
uint32 file_cnt;
uint16 mode;
uint16 language;
uint16 compatibility;
uint16 gph_type;
uint16 shot_by_PPS;
uint16 det_type;
uint16 high_voltage;
uint16 ccf_threshold;
uint16 private_code;
uint16 fire_delay;
uint16 radio_delay;
uint16 radio_ampl;
uint16 CTB_max;
uint16 UHT_min;
131
Сиб Геофиз ПриборРуководство по эксплуатации
uint16 UHT_mode;
uint16 UHT_test;
uint16 time_zone;
uint16 time_slot;
uint16 shooter_amount;
int16 r0_uh;
int16 r0_cap;
int16 adc_null;
char gga[128];
uint16 det_info;
uint32 det_number;
uint16 shift;
uint16 noise;
int16 data[2000];
};
Элемент uht — зарегистрированное вертикальное время, единица младшего
разряда равна 100 мкс.
Элемент ctb — задержка детонатора в единицах микросекунд..
Элементы r_uht, r_cap — сопротивления датчика вертикального времени
(геофона) и взрывной цепи перед взрывом в Омах.
Элемент ccf_max — пиковое значение на выходе корреляционного обработчика
радиосигнала при приёме команды в процентах.
Элемент Imax — пиковое значение тока во взрывной цепи, единица младшего
разряда равна 100 мА.
Элемент Uin — напряжение питания синхронизатора, единица младшего
разряда равна 100 мВ.
Следующие 7 элементов представляют дату и время момента подачи высокого
напряжения на клеммы «CAP». Формат представления времени зависит от того,
были ли RTC синхронизированы с точным GPS временем, и от значения
элемента file_version.
При отсутствии синхронизации с GPS/ГЛОНАСС приёмником или при
значении file_version = 0 (устаревший формат):
• t0 = shooting_year = (год — 2000). Если время и дата недействительны
(нет синхронизации с GPS временем и при этом элемент питания RTC
разряжен), то t0 = 0xFF. В этом случае остальные элементы
132
Сиб Геофиз ПриборСистема синхронизации SGD-S
•
•
•
•
•
•
представления времени недействительны;
t1 = shooting_month = (месяц — 1);
t2 = shooting_day = (день — 1);
t3 = shooting_hour = час;
t4 = shooting_minute = минута;
t5 = shooting_second = секунда;
microsec = доли секунды в микросекундах, 0 … 999999. Если RTC не
были синхронизированы с GPS/ГЛОНАСС приёмником, здесь всегда
будет 0xFFFFFFFF.
Если file_version = 1 и RTC синхронизированы с GPS/ГЛОНАСС приёмником:
• t1:t0 = shooting_gps_week = «GPS week number», тип uint16, t1 — старший
байт;
• t4:t3:t2 = shooting_gps_time = «GPS time of week» в секундах, 24 разряда,
t4 — старший байт;
• Tus = доли секунды в микросекундах, 0 … 999999;
• t5 = leap seconds, разность между GPS и UTC временем.
Элемент serial_number — десятичное число, представляющее дату выпуска и
номер синхронизатора, например «17012001» - год 2017, месяц 01, номер 2001.
Следующие 4 элемента характеризуют пикет взрыва:
• shot_point — номер пикета взрыва (ПВ);
• SP_step — шаг изменения ПВ;
• line_number — номер профиля;
• file_cnt — номер записи.
Следующие 19 элементов — значения параметров настройки синхронизатора:
• mode — режим работы, 0 - «ВЕДОМЫЙ», 1 - «ТЕСТ СВЯЗИ», 2 -
«РЕПЕТИР», 3 - «АВТОНОМНЫЙ»;
• language — язык интерфейса, 0 — английский, 1 — русский;
• compatibility — совместимость с версией 7, 0 — нет, 1 — есть;
• gph_type — тип датчика вертикального времени, 0 — аналоговый, 1 —
цифровой;
• shot_by_PPS — состояние параметра «Взрыв по PPS»;
• det_type — тип детонатора, 0 — обычный, 1 — электронный (для
будущих применений);
• high_voltage — напряжение заряда конденсатора, 100+high_voltage*50
Вольт;
• ccf_threshold — порог срабатывания корреляционного приёмника в
процентах;
• private_code — номер кода;
• fire_delay — задержка от НО, единица младшего разряда равна 100 мкс;
133
Сиб Геофиз ПриборРуководство по эксплуатации
• radio_delay — задержка в радиоканале, единица младшего разряда равна
10 мкс;
• radio_ampl — двойная амплитуда на входе радиостанции, единица
младшего разряда равна 25 мВ;
• CTB_max — максимальное значение ConfTB, единица младшего разряда
равна 100 мкс;;
• UHT_min — минимальное значение вертикального времени, единица
младшего разряда равна 100 мкс;;
• UHT_mode — способ проверки датчика вертикального времени, 0 —
только сопротивление, 1 — мягкий, 2 — строгий;
• UHT_test — тестовое значение вертикального времени, единица
младшего разряда равна 100 мкс;
• time_zone — часовой пояс;
• time_slot — «Длина записи» в секундах (см. Раздел 4.6);
• shooter_amount — «Взрывников» (см. Раздел 4.6).
Элементы r0_uh, r0_cap, adc_null — результаты калибровки ом-метра.
Элемент gga[] — null-terminated строка сообщения $GPGGA/$GNGGA,
полученного от GPS/ГЛОНАСС приёмника.
Элементы det_info, det_number — параметры электронного детонатора (для
будущих применений).
Элемент shift. АЦП канала вертикального времени имеет 18 разрядов, но в
памяти сохраняются только 16 разрядов. Элемент shift показывает, какая часть
разрядной шкалы сохраняется:
• 0 — младшие 16 разрядов, эквивалент коэффициента усиления 4;
• 1 — разряды 1...17, эквивалент коэффициента усиления 2;
• 2 — разряды 2...18, эквивалент коэффициента усиления 1;
Элемент noise — амплитуда шума в канале вертикального времени,
зарегистрированного перед взрывом, в единицах АЦП, сдвинутая вправо на
shift разрядов, т.е. в той же шкале, что и данные ниже.
Элемент data[] — отсчёты канала вертикального времени в единицах АЦП,
сдвинутые вправо на shift разрядов. Представление отсчётов — дополнение до
двух (two`s complement).